---
import { Image } from 'astro:assets'
import logo from '../assets/images/logo.webp'

const links = [
  { name: 'Inicio', href: '#' },
  { name: 'Servicios', href: '#services' },
  { name: 'Ubicación', href: '#location' },
  { name: 'Contacto', href: '#footer' },
]

const phoneNumber = '593991150542'
const message = 'Hola, me gustaría obtener más información sobre Villa Margaritas.'
const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`
---

<nav
  id="navbar"
  class="fixed top-0 z-50 flex w-full items-center justify-between px-4 py-6 transition-all duration-300 md:px-12"
>
  <a href="/" id="nav-logo" class="block transition-transform duration-300 hover:scale-105">
    <Image
      loading="eager"
      fetchpriority="high"
      id="logo-img"
      src={logo}
      alt="Villa Margaritas Logo"
      class="h-24 w-auto object-contain transition-all duration-300"
    />
  </a>

  <ul class="hidden gap-8 md:flex">
    {
      links.map((link) => (
        <li>
          <a
            href={link.href}
            class="nav-link hover:text-primary font-sans text-sm font-medium tracking-widest text-white uppercase transition-colors duration-300"
          >
            {link.name}
          </a>
        </li>
      ))
    }
  </ul>

  <a
    href={whatsappUrl}
    target="_blank"
    rel="noopener noreferrer"
    class="bg-primary hover:text-primary hover:border-primary hidden cursor-pointer border border-transparent px-8 py-3 font-sans text-xs font-bold tracking-widest text-white uppercase transition-colors duration-300 hover:bg-white md:block"
  >
    Reservar
  </a>

  <!-- Mobile Menu Button -->
  <button
    id="mobile-menu-btn"
    class="relative z-50 text-2xl text-white transition-colors duration-300 md:hidden"
  >
    ☰
  </button>

  <!-- Mobile Menu Overlay -->
  <div
    id="mobile-menu"
    class="pointer-events-none fixed inset-0 z-40 flex flex-col items-center justify-center bg-black/95 opacity-0 transition-opacity duration-300"
  >
    <ul class="flex flex-col gap-8 text-center">
      {
        links.map((link, index) => (
          <li>
            <a
              href={link.href}
              class="mobile-nav-link hover:text-primary animate-fade-up font-serif text-2xl text-white italic transition-colors duration-300"
              style={`animate-delay: ${index * 200}ms;`}
            >
              {link.name}
            </a>
          </li>
        ))
      }
    </ul>
    <a
      href={whatsappUrl}
      target="_blank"
      rel="noopener noreferrer"
      class="bg-primary hover:text-primary hover:border-primary mt-12 border border-transparent px-10 py-4 font-sans text-sm font-bold tracking-widest text-white uppercase transition-colors duration-300 hover:bg-white"
    >
      Reservar
    </a>
  </div>
</nav>

<script>
  const navbar = document.getElementById('navbar')
  const navLogo = document.getElementById('nav-logo')
  const logoImg = document.getElementById('logo-img')
  const navLinks = document.querySelectorAll('.nav-link')
  const mobileMenuBtn = document.getElementById('mobile-menu-btn')

  const mobileMenu = document.getElementById('mobile-menu')
  const mobileNavLinks = document.querySelectorAll('.mobile-nav-link')

  mobileMenuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('opacity-0')
    mobileMenu?.classList.toggle('pointer-events-none')

    if (mobileMenu?.classList.contains('opacity-0')) {
      mobileMenuBtn.textContent = '☰'
      mobileMenuBtn.classList.remove('text-dark') 
      mobileMenuBtn.classList.add('text-white')
    } else {
      mobileMenuBtn.textContent = '✕'
      mobileMenuBtn.classList.remove('text-dark')
      mobileMenuBtn.classList.add('text-white') 
    }
  })

  mobileNavLinks.forEach((link) => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('opacity-0')
      mobileMenu?.classList.add('pointer-events-none')
      if (mobileMenuBtn) mobileMenuBtn.textContent = '☰'
    })
  })

  window.addEventListener('scroll', () => {
    const isMenuOpen = !mobileMenu?.classList.contains('opacity-0')

    if (window.scrollY > 50) {
      navbar?.classList.add('bg-white', 'shadow-md', 'py-4')
      navbar?.classList.remove('py-6')

      logoImg?.classList.remove('h-24')
      logoImg?.classList.add('h-12')

      if (!isMenuOpen) {
        mobileMenuBtn?.classList.remove('text-white')
        mobileMenuBtn?.classList.add('text-dark')
      }

      navLinks.forEach((link) => {
        link.classList.remove('text-white')
        link.classList.add('text-dark')
      })
    } else {
      navbar?.classList.remove('bg-white', 'shadow-md', 'py-4')
      navbar?.classList.add('py-6')

      logoImg?.classList.add('h-24')
      logoImg?.classList.remove('h-12')

      mobileMenuBtn?.classList.add('text-white')
      mobileMenuBtn?.classList.remove('text-dark')

      navLinks.forEach((link) => {
        link.classList.add('text-white')
        link.classList.remove('text-dark')
      })
    }
  })
</script>
